#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", fill="Grant Award") + theme_classic() + geom_histogram()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", fill="Grant Award") + theme_classic() + facet_wrap() + geom_histogram()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", fill="Grant Award") + theme_classic() + facet_wrap(~'city_town') + geom_histogram()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", fill="Grant Award") + theme_classic() + facet_wrap() + geom_histogram()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", fill="Grant Award") + theme_classic() + facet_wrap(~city_town) + geom_histogram()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding") + theme_classic() + facet_wrap(~city_town) + geom_histogram()
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding") + theme_classic() + facet_wrap(~city_town) + geom_histogram()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town), show.legend = FALSE) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding") + theme_classic() + facet_wrap(~city_town) + geom_histogram()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town), show.legend = FALSE) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", show.legend = FALSE) + theme_classic() + facet_wrap(~city_town) + geom_histogram()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town), show.legend = FALSE) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", show.legend = FALSE) + theme_classic() + facet_wrap(~city_town) + geom_histogram(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town), show.legend = FALSE) + labs(x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", show.legend = FALSE) + theme_classic() + facet_wrap(~city_town) + geom_histogram(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, fill=city_town), show.legend = FALSE) + labs(x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", show.legend = FALSE) + facet_wrap(~city_town) + geom_histogram(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatter Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=per_capita_income_in_2020_inflation_adjusted_dollars, fill=city_town), show.legend = FALSE) + labs(x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", show.legend = FALSE) + facet_wrap(~city_town) + geom_histogram(show.legend = FALSE)
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", fill="Grant Award") + theme_classic() + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", fill="Grant Award", xlim(0,1)) + theme_classic() + geom_bar()
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", fill="Grant Award", xlim(0,1)) + theme_classic() + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index, color=social_vulnerability_cdc_index)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", fill="Grant Award", xlim(0,1)) + theme_classic() + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index, color=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", fill="Grant Award", xlim(0,1)) + theme_classic() + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index, color=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of the communities which received funding", fill="Grant Award", xlim(0,1)) + theme_classic() + geom_bar(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index, color=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of communities who Recieved Grants", fill="Grant Award", xlim(0,1)) + theme_classic() + geom_bar(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Histograms visualizing the Per Capita income in 2020 of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=per_capita_income_in_2020_inflation_adjusted_dollars, fill=city_town), show.legend = FALSE) + labs(x = "Per Capita income in 2020 inflation adjusted dollars", title = "Per Capita income in 2020 inflation adjusted dollars of the communities which received funding", show.legend = FALSE) + facet_wrap(~city_town) + geom_histogram(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Histograms visualizing the Per Capita income in 2020 of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=per_capita_income_in_2020_inflation_adjusted_dollars, fill=city_town), show.legend = FALSE) + labs(x = "Per Capita income in 2020 inflation adjusted dollars", title = "Per Capita Income in 2020 of Communities Which Received a Grant", show.legend = FALSE) + facet_wrap(~city_town) + geom_histogram(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between social vulnerability index and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town)) + labs(x = "Per Capita income in 2020 inflation adjusted dollars", title = "Per Capita Income in 2020 of Communities Which Received a Grant") + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between social vulnerability index and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town, color=city_town)) + labs(x = "Social Vulnerability CDC Index", y="Total percent of Land at Some Level of Flood Risk", title = "Per Capita Income in 2020 of Communities Which Received a Grant") + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Bar Plot visualizing which communties recieved grants and how much they recieved.
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=grant_award)) + labs(y = "City/Town", x = "Grant Award in Thousands", title = "Grant Awarded to Each City/Town", fill="Grant Awarded") + theme_classic() + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index, color=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of communities who Recieved Grants", fill="Grant Award") + theme_classic() + geom_bar(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between social vulnerability index and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=social_vulnerability_cdc_index, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town, color=city_town)) + labs(x = "Social Vulnerability CDC Index", y="Total percent of Land at Some Level of Flood Risk", title = "Areas with Flood Risk and CDC Social Vulnerability Index", fill="City/Town") + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, y=total_percent_of_land_at_some_level_of_flood_risk)) + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, y=total_percent_of_land_at_some_level_of_flood_risk)) + geom_boxplot()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, y=total_percent_of_land_at_some_level_of_flood_risk)) + geom_line()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=grant_award, x=total_percent_of_land_at_some_level_of_flood_risk)) + geom_line()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, fill=total_percent_of_land_at_some_level_of_flood_risk)) + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, fill=total_percent_of_land_at_some_level_of_flood_risk)) + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, y=total_percent_of_land_at_some_level_of_flood_risk)) + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town)) + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town, color=city_town)) + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town, shape=city_town)) + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town, color=city_town)) + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Histograms visualizing the Per Capita income in 2020 of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=per_capita_income_in_2020_inflation_adjusted_dollars, fill=city_town), show.legend = FALSE) + labs(x = "Per Capita income in 2020 inflation adjusted dollars", title = "Per Capita Income in 2020 of Communities Which Received a Grant", show.legend = FALSE) + facet_wrap(~city_town) + geom_density(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town, color=city_town)) +  geom_point(alpha = 1.5)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, y=total_percent_of_land_at_some_level_of_flood_risk)) +  geom_point(alpha = 1.5)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Scatterplot visualizing the relationship between grant awarded and percent of area flooded
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=grant_award, y=total_percent_of_land_at_some_level_of_flood_risk)) +  labs(x = "Grant Award", y="Total percent of Land at Some Level of Flood Risk", title = "Areas with Flood Risk and Grant Awarded") + geom_point(alpha = 1.5)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
p1 <-   data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=total_population, fill=city_town, color=city_town)) + labs(x = "Social Vulnerability CDC Index", y="Total percent of Land at Some Level of Flood Risk", title = "Areas with Flood Risk and CDC Social Vulnerability Index", fill="City/Town") + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=total_population, fill=city_town, color=city_town)) + labs(x = "Social Vulnerability CDC Index", y="Total percent of Land at Some Level of Flood Risk", title = "Areas with Flood Risk and CDC Social Vulnerability Index", fill="City/Town") + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=total_population, fill=city_town, color=city_town)) + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(fill=total_population, y=city_town, color=city_town)) + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(fill=total_population, x=city_town, color=city_town)) + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(fill=total_population, y=city_town, color=city_town)) + geom_bar()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(fill=total_population, y=city_town, color=city_town)) + geom_bar(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
p1 <- data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(fill=total_population, y=city_town, color=city_town)) + geom_bar(show.legend = FALSE)
p2 <- data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=grant_award)) + labs(y = "City/Town", x = "Grant Award in Thousands", title = "Grant Awarded to Each City/Town", fill="Grant Awarded") + theme_classic() + geom_bar()
p1 + p2
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
p1 <- data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(fill=total_population, y=city_town, color=city_town)) + labs(y = "City/Town", x = "Population", title = "Population of each City/Town") + geom_bar(show.legend = FALSE)
p2 <- data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=grant_award)) + labs(y = "City/Town", x = "Grant Award in Thousands", title = "Grant Awarded to Each City/Town", fill="Grant Awarded") + theme_classic() + geom_bar()
p1 + p2
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
df1 <- lm(grant_award ~ city_town, data = data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)))
summary(df2)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
df1 <- lm(grant_award ~ city_town, data = data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)))
summary(df1)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
df1 <- lm(city_town ~ grant_award, data = data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)))
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
df1 <- lm(grant_award ~ city_town, data = data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)))
summary(df1)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#multiple linear regression on the grant award, amount of flooding and the city/town
df2 <- lm(grant_award + total_percent_of_land_at_some_level_of_flood_risk ~ city_town, data = data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)))
summary(df2)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index, color=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of communities who Recieved Grants", fill="Grant Award", log="y") + theme_classic() + geom_bar(show.legend = FALSE)
library(tidyverse)
library(ggplot2)
library(patchwork)
library(GGally)
library(tidyverse)
library(janitor)
setwd('/Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698')
getwd()
data <- read_csv('final_data_with_golden_leaf.csv')
data <- clean_names(data)
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index, color=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of communities who Recieved Grants", fill="Grant Award", log="y") + theme_classic() + geom_bar(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index, color=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of communities who Recieved Grants", fill="Grant Award", log="y") + scale_x_continuous(trans='log10') + theme_classic() + geom_bar(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Bar Plot visualizing the CDC social vulnerability index of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(y=city_town, fill=social_vulnerability_cdc_index, color=city_town)) + labs(y = "City/Town", x = "Social Vulnerability Index", title = "CDC social vulnerability index of communities who Recieved Grants", fill="Grant Award", log="y") + theme_classic() + geom_bar(show.legend = FALSE)
View(data)
library(tidyverse)
library(ggplot2)
library(knitr)
library(patchwork)
library(GGally)
library(skimr)
library(factoextra)
library(ggfortify)
library(magrittr)
source("Unit_13_functions.R")
knitr::opts_chunk$set(fig.asp = 1.2, fig.align = "center", message=FALSE, out.width = "70%")
#knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/715/week-13-hw-dkwilson27')
UESI <- read.csv('data/UESI.csv')
UESI.scaled <- UESI.scaled <- UESI %>%
magrittr::set_rownames(.$City)  %>%
dplyr::select_if(is.numeric) %>% #alternative - use df %>% dplyr::select_if(is.numeric)
# mutate_at(vars(contains("UESI")), funs(scale(.))) %>% # updated way is to use 'across'
mutate(across(contains("UESI"), scale)) %>%
dplyr::select(contains("UESI")) %>%
drop_na()
View(UESI)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Histograms visualizing the Per Capita income in 2020 of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=per_capita_income_in_2020_inflation_adjusted_dollars, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town), show.legend = FALSE) + labs(x = "Per Capita income in 2020 inflation adjusted dollars", title = "Per Capita Income in 2020 of Communities Which Received a Grant", show.legend = FALSE)  + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Histograms visualizing the Per Capita income in 2020 of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=per_capita_income_in_2020_inflation_adjusted_dollars, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town, color=city_town), show.legend = FALSE) + labs(x = "Per Capita income in 2020 inflation adjusted dollars", title = "Per Capita Income in 2020 of Communities Which Received a Grant", show.legend = FALSE)  + geom_point()
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Histograms visualizing the Per Capita income in 2020 of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=per_capita_income_in_2020_inflation_adjusted_dollars, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town), show.legend = FALSE) + labs(x = "Per Capita income in 2020 inflation adjusted dollars", title = "Per Capita Income in 2020 of Communities Which Received a Grant", show.legend = FALSE) + facet_wrap(~city_town) + geom_density(show.legend = FALSE)
#Histograms visualizing the Per Capita income in 2020 of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=per_capita_income_in_2020_inflation_adjusted_dollars, y=total_percent_of_land_at_some_level_of_flood_risk, fill=city_town), show.legend = FALSE) + labs(x = "Per Capita income in 2020 inflation adjusted dollars", title = "Per Capita Income in 2020 of Communities Which Received a Grant", show.legend = FALSE) + facet_wrap(~city_town) + geom_density(show.legend = FALSE)
knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/EDF/Flood_Analysis_PLCY_698') # change for your root directory)
#Histograms visualizing the Per Capita income in 2020 of the communities which received funding
data %>%
filter(!is.na(city_town)) %>%
filter(!is.na(grant_award)) %>%
ggplot(aes(x=per_capita_income_in_2020_inflation_adjusted_dollars, fill=city_town), show.legend = FALSE) + labs(x = "Per Capita income in 2020 inflation adjusted dollars", title = "Per Capita Income in 2020 of Communities Which Received a Grant", show.legend = FALSE) + facet_wrap(~city_town) + geom_density(show.legend = FALSE)
UESI <- read.csv('data/UESI.csv')
UESI.scaled <- UESI.scaled <- UESI %>%
magrittr::set_rownames(.$City)  %>%
dplyr::select_if(is.numeric) %>% #alternative - use df %>% dplyr::select_if(is.numeric)
# mutate_at(vars(contains("UESI")), funs(scale(.))) %>% # updated way is to use 'across'
mutate(across(contains("GDPpc_mean", "popdens", "area_total", "population_total", "NBDI", "NDVI"), scale)) %>%
dplyr::select(contains("GDPpc_mean", "popdens", "area_total", "population_total", "NBDI", "NDVI")) %>%
drop_na()
UESI <- read.csv('data/UESI.csv')
UESI.scaled <- UESI.scaled <- UESI %>%
magrittr::set_rownames(.$City)  %>%
dplyr::select_if(is.numeric) %>% #alternative - use df %>% dplyr::select_if(is.numeric)
# mutate_at(vars(contains("UESI")), funs(scale(.))) %>% # updated way is to use 'across'
mutate(across(-contains("UESI"), scale)) %>%
dplyr::select(-contains("UESI")) %>%
drop_na()
View(UESI.scaled)
pca2.UESI <- UESI.scaled
scree_plot <- data.frame(summary(pca2.UESI)$importance) %>%
mutate(metric = row.names(.)) %>%
filter(metric == "Proportion of Variance") %>%
pivot_longer(!c("metric"), names_to="PC", values_to="Prop") %>%
mutate(PC = fct_reorder(PC, -Prop)) %>%
ungroup() %>%
ggplot(aes(x=PC, y=Prop, group=1)) +
geom_line() +
geom_point() +
labs(title="Scree Plot") +
theme_bw()
pca.UESI <- prcomp(df.pca %>% select(-contains("UESI")))
pca.UESI <- prcomp(UESI.scaled %>% select(-contains("UESI")))
scree_plot <- data.frame(summary(pca.UESI)$importance) %>%
mutate(metric = row.names(.)) %>%
filter(metric == "Proportion of Variance") %>%
pivot_longer(!c("metric"), names_to="PC", values_to="Prop") %>%
mutate(PC = fct_reorder(PC, -Prop)) %>%
ungroup() %>%
ggplot(aes(x=PC, y=Prop, group=1)) +
geom_line() +
geom_point() +
labs(title="Scree Plot") +
theme_bw()
View(scree_plot)
library(tidyverse)
library(ggplot2)
library(knitr)
library(patchwork)
library(GGally)
library(skimr)
library(factoextra)
library(ggfortify)
library(magrittr)
source("Unit_13_functions.R")
knitr::opts_chunk$set(fig.asp = 1.2, fig.align = "center", message=FALSE, out.width = "70%")
#knitr::opts_chunk$set(root.dir='Users/devinwilson/Documents/715/week-13-hw-dkwilson27')
scree_plot <- data.frame(summary(pca.UESI)$importance) %>%
mutate(metric = row.names(.)) %>%
filter(metric == "Proportion of Variance") %>%
pivot_longer(!c("metric"), names_to="PC", values_to="Prop") %>%
mutate(PC = fct_reorder(PC, -Prop)) %>%
ungroup() %>%
ggplot(aes(x=PC, y=Prop, group=1)) +
geom_line() +
geom_point() +
labs(title="Scree Plot") +
theme_bw()
scree_plot <- data.frame(summary(pca.UESI)$importance) %>%
mutate(metric = row.names(.)) %>%
filter(metric == "Proportion of Variance") %>%
pivot_longer(!c("metric"), names_to="PC", values_to="Prop") %>%
mutate(PC = fct_reorder(PC, -Prop)) %>%
ungroup() %>%
ggplot(aes(x=PC, y=Prop, group=1)) +
geom_line() +
geom_point() +
labs(title="Scree Plot") +
theme_bw()
View(scree_plot)
scree_plot2 <- data.frame(summary(pca.UESI)$importance) %>%
mutate(metric = row.names(.)) %>%
filter(metric == "Proportion of Variance") %>%
pivot_longer(!c("metric"), names_to="PC", values_to="Prop") %>%
mutate(PC = fct_reorder(PC, -Prop)) %>%
ungroup() %>%
ggplot(aes(x=PC, y=Prop, group=1)) +
geom_line() +
geom_point() +
labs(title="Scree Plot") +
theme_bw()
k4 <- kmeans(df.pca %>% dplyr::select(contains("UESI")), centers = 7, nstart = 1000,
algorithm = 'Lloyd')
k4 <- kmeans(UESI.pca %>% dplyr::select(contains("UESI")), centers = 7, nstart = 1000,
algorithm = 'Lloyd')
k7 <- kmeans(pca.UESI %>% dplyr::select(contains("UESI")), centers = 7, nstart = 1000,
algorithm = 'Lloyd')
# Calculate PC scores for cities
PC1 <- as.matrix(pca.UESI %>% dplyr::select(-contains("UESI"))) %*% as.matrix(pca.UESI$rotation[,1]) # %*% is matrix multiplication
pca.UESI <- prcomp(UESI.scaled %>% select(-contains("UESI")))
k7 <- kmeans(pca.UESI %>% dplyr::select(contains("UESI")), centers = 7, nstart = 1000,
algorithm = 'Lloyd')
